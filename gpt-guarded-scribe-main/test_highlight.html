<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ CopyKiller - ì™„ì „ì²´ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 20px;
        }
        .panel {
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            padding: 20px;
            background: #f8f9fa;
        }
        .input-section {
            margin-bottom: 20px;
        }
        textarea {
            width: 100%;
            height: 150px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            resize: vertical;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        button:hover {
            background: #0056b3;
        }
        .result-text {
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            min-height: 200px;
            margin-top: 15px;
            line-height: 1.8;
        }
        .highlight-old {
            background-color: #ffeb3b;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .highlight-new {
            background-color: #ffebee;
            border-left: 3px solid #f44336;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 500;
            color: #c62828;
        }
        .status {
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-weight: 500;
        }
        .status.checking {
            background: #e3f2fd;
            color: #1976d2;
            border: 1px solid #2196f3;
        }
        .status.success {
            background: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #4caf50;
        }
        .status.error {
            background: #ffebee;
            color: #d32f2f;
            border: 1px solid #f44336;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
        }
        h2 {
            color: #555;
            border-bottom: 2px solid #eee;
            padding-bottom: 5px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        .info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
        }
        .matches-info {
            margin-top: 15px;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 6px;
            font-size: 13px;
        }
        .premium-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: white;
            border: 2px solid transparent;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
        }
        .feature-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        .badge-success { background: #e8f5e8; color: #2e7d32; }
        .badge-warning { background: #fff3e0; color: #f57c00; }
        .badge-danger { background: #ffebee; color: #d32f2f; }
        .badge-info { background: #e3f2fd; color: #1976d2; }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 8px 0;
        }
        .progress-fill {
            height: 100%;
            transition: width 0.3s ease;
        }
        .tabs {
            border-bottom: 2px solid #eee;
            margin-bottom: 20px;
        }
        .tab {
            display: inline-block;
            padding: 12px 20px;
            border: none;
            background: none;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            margin-right: 10px;
        }
        .tab.active {
            border-bottom-color: #667eea;
            color: #667eea;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .ai-suggestion {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #ff6b6b;
        }
        .improvement-section {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <h1>ğŸš€ CopyKiller - ì™„ì „ì²´ ê¸°ëŠ¥ ë°ëª¨</h1>
    <p class="subtitle">AI ê¸°ë°˜ ì°¨ì„¸ëŒ€ í‘œì ˆ ê²€ì‚¬ ì‹œìŠ¤í…œì˜ ëª¨ë“  ê¸°ëŠ¥ì„ í•œëˆˆì—!</p>

    <div class="premium-card">
        <h2 style="margin-top: 0;">âœ¨ í”„ë¦¬ë¯¸ì—„ AI ê¸°ëŠ¥ í¬í•¨</h2>
        <p>â€¢ ğŸ¯ ì •í™•í•œ í•˜ì´ë¼ì´íŠ¸ â€¢ ğŸ¤– AI ê¸€ì“°ê¸° ë¶„ì„ â€¢ ğŸ’¡ ìŠ¤ë§ˆíŠ¸ ê°œì„  ì œì•ˆ â€¢ ğŸ” ë§¥ë½ ê¸°ë°˜ ë¶„ì„</p>
    </div>

    <div class="info">
        <strong>ğŸ“¡ ë°±ì—”ë“œ ìƒíƒœ:</strong> <span id="backend-status">í™•ì¸ ì¤‘...</span><br>
        <strong>ğŸ”§ ê°œì„ ì‚¬í•­:</strong> ì „ì²´ ë¬¸ì¥ â†’ ì •í™•í•œ ë§¤ì¹­ êµ¬ê°„ë§Œ í•˜ì´ë¼ì´íŠ¸
    </div>

    <div class="input-section">
        <textarea id="testText" placeholder="í‘œì ˆ ê²€ì‚¬í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">ì¸ê³µì§€ëŠ¥ì€ í˜„ëŒ€ ê¸°ìˆ  ë°œì „ì˜ í•µì‹¬ ìš”ì†Œì…ë‹ˆë‹¤. ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹ì„ í†µí•´ ì»´í“¨í„°ê°€ í•™ìŠµí•˜ê³  íŒë‹¨í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ìì—°ì–´ ì²˜ë¦¬ì™€ ì»´í“¨í„° ë¹„ì „ ê°™ì€ ë¶„ì•¼ì—ì„œ í˜ì‹ ì ì¸ ì„±ê³¼ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê¸°ìˆ ë“¤ì´ ê²°í•©ë˜ì–´ ì¸ê°„ì˜ ì¸ì§€ ëŠ¥ë ¥ì„ ëª¨ë°©í•˜ê³  ë•Œë¡œëŠ” ëŠ¥ê°€í•˜ëŠ” ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ë‚´ê³  ìˆìŠµë‹ˆë‹¤.</textarea>
        <br>
        <div style="margin-top: 15px;">
            <button onclick="runFullAnalysis()">ğŸš€ ì „ì²´ AI ë¶„ì„ (ëª¨ë“  ê¸°ëŠ¥)</button>
            <button onclick="checkBasicPlagiarism()" style="margin-left: 10px; background: #007bff;">ğŸ” ê¸°ë³¸ í‘œì ˆ ê²€ì‚¬</button>
            <button onclick="showAllFeatures()" style="margin-left: 10px; background: #28a745;">ï¿½ ê¸°ëŠ¥ ë¯¸ë¦¬ë³´ê¸°</button>
        </div>
    </div>

    <div class="container">
        <div class="panel">
            <h2>âŒ ê¸°ì¡´ ë°©ì‹ (ë¬¸ì œ)</h2>
            <div class="result-text" id="oldResult">
                <p>ì „ì²´ ë¬¸ì¥ì´ í•˜ì´ë¼ì´íŠ¸ë˜ëŠ” ë¬¸ì œ:</p>
                <p><span class="highlight-old">ì¸ê³µì§€ëŠ¥ì€ í˜„ëŒ€ ê¸°ìˆ  ë°œì „ì˜ í•µì‹¬ ìš”ì†Œì…ë‹ˆë‹¤.</span> <span class="highlight-old">ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹ì„ í†µí•´ ì»´í“¨í„°ê°€ í•™ìŠµí•˜ê³  íŒë‹¨í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</span></p>
                <p>â†’ ë¶€ì •í™•í•˜ê³  ê³¼ë„í•œ í•˜ì´ë¼ì´íŠ¸</p>
            </div>
        </div>

        <div class="panel">
            <h2>âœ… ê°œì„ ëœ ë°©ì‹ (í•´ê²°)</h2>
            <div class="result-text" id="newResult">
                <p>ì •í™•í•œ ë§¤ì¹­ êµ¬ê°„ë§Œ í•˜ì´ë¼ì´íŠ¸:</p>
                <p>ì¸ê³µì§€ëŠ¥ì€ <span class="highlight-new">í˜„ëŒ€ ê¸°ìˆ  ë°œì „</span>ì˜ í•µì‹¬ ìš”ì†Œì…ë‹ˆë‹¤. <span class="highlight-new">ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹</span>ì„ í†µí•´ ì»´í“¨í„°ê°€ í•™ìŠµí•˜ê³  íŒë‹¨í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                <p>â†’ ì •í™•í•˜ê³  ëª…í™•í•œ í‘œì ˆ êµ¬ê°„ í‘œì‹œ</p>
            </div>
        </div>
    </div>

    <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="tabs" id="mainTabs">
        <button class="tab active" onclick="showTab('basic')">ğŸ” ê¸°ë³¸ ê²€ì‚¬</button>
        <button class="tab" onclick="showTab('ai-analysis')">ğŸ¤– AI ë¶„ì„</button>
        <button class="tab" onclick="showTab('context')">ğŸ¯ ë§¥ë½ ë¶„ì„</button>
        <button class="tab" onclick="showTab('suggestions')">ğŸ’¡ ê°œì„  ì œì•ˆ</button>
        <button class="tab" onclick="showTab('premium')">âœ¨ í”„ë¦¬ë¯¸ì—„</button>
    </div>

    <!-- ê¸°ë³¸ í‘œì ˆ ê²€ì‚¬ -->
    <div id="basic" class="tab-content active">
        <div id="basicResult"></div>
    </div>

    <!-- AI ê¸€ì“°ê¸° ë¶„ì„ -->
    <div id="ai-analysis" class="tab-content">
        <div id="aiAnalysisResult"></div>
    </div>

    <!-- ë§¥ë½ ë¶„ì„ -->
    <div id="context" class="tab-content">
        <div id="contextResult"></div>
    </div>

    <!-- ê°œì„  ì œì•ˆ -->
    <div id="suggestions" class="tab-content">
        <div id="suggestionsResult"></div>
    </div>

    <!-- í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥ -->
    <div id="premium" class="tab-content">
        <div id="premiumResult"></div>
    </div>

    <div id="apiResult" style="margin-top: 30px;"></div>

    <script>
        let currentAnalysisData = {
            basicResult: null,
            aiAnalysis: null,
            contextAnalysis: null,
            suggestions: null
        };

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function showTab(tabName) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // ì „ì²´ AI ë¶„ì„ ì‹¤í–‰
        async function runFullAnalysis() {
            const text = document.getElementById('testText').value;
            
            // ëª¨ë“  íƒ­ì— ë¡œë”© ìƒíƒœ í‘œì‹œ
            showLoadingState();
            
            try {
                // 1. ê¸°ë³¸ í‘œì ˆ ê²€ì‚¬
                await runBasicPlagiarismCheck(text);
                
                // 2. AI ê¸€ì“°ê¸° ë¶„ì„
                await runAIAnalysis(text);
                
                // 3. ë§¥ë½ ë¶„ì„ (í‘œì ˆ ê²°ê³¼ê°€ ìˆì„ ë•Œ)
                if (currentAnalysisData.basicResult && currentAnalysisData.basicResult.matches) {
                    await runContextAnalysis(text, currentAnalysisData.basicResult.matches);
                }
                
                // 4. ê°œì„  ì œì•ˆ
                if (currentAnalysisData.basicResult && currentAnalysisData.basicResult.matches) {
                    await runImprovementSuggestions(text, currentAnalysisData.basicResult.matches);
                }
                
                // 5. í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥ ìš”ì•½
                displayPremiumSummary();
                
            } catch (error) {
                displayError('ì „ì²´ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ë¡œë”© ìƒíƒœ í‘œì‹œ
        function showLoadingState() {
            const tabs = ['basic', 'ai-analysis', 'context', 'suggestions', 'premium'];
            tabs.forEach(tab => {
                document.getElementById(tab).innerHTML = `
                    <div class="status checking">
                        <div class="loading-spinner"></div>
                        AI ë¶„ì„ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”
                    </div>
                `;
            });
        }

        // ë°±ì—”ë“œ ìƒíƒœ í™•ì¸
        async function checkBackendStatus() {
            try {
                const response = await fetch('http://localhost:8006/health');
                if (response.ok) {
                    document.getElementById('backend-status').innerHTML = 'âœ… ì •ìƒ ì‘ë™ (í¬íŠ¸ 8006)';
                    document.getElementById('backend-status').style.color = '#2e7d32';
                } else {
                    throw new Error('ì—°ê²° ì‹¤íŒ¨');
                }
            } catch (error) {
                document.getElementById('backend-status').innerHTML = 'âŒ ì—°ê²° ì•ˆë¨ (ëª¨ì˜ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥)';
                document.getElementById('backend-status').style.color = '#d32f2f';
            }
        }

        // ê¸°ë³¸ í‘œì ˆ ê²€ì‚¬
        async function runBasicPlagiarismCheck(text) {
            try {
                const response = await fetch('http://localhost:8006/api/check/text', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: text, check_web: true })
                });

                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                currentAnalysisData.basicResult = data;
                displayBasicResults(data, text);
                return data;
                
            } catch (error) {
                displayMockBasicResults(text);
                return null;
            }
        }

        // AI ê¸€ì“°ê¸° ë¶„ì„
        async function runAIAnalysis(text) {
            try {
                const response = await fetch('http://localhost:8006/api/premium/advanced-analysis', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: text })
                });

                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                currentAnalysisData.aiAnalysis = data.analysis;
                displayAIAnalysisResults(data.analysis);
                return data;
                
            } catch (error) {
                displayMockAIAnalysis(text);
                return null;
            }
        }

        // ë§¥ë½ ë¶„ì„
        async function runContextAnalysis(text, matches) {
            try {
                const response = await fetch('http://localhost:8006/api/premium/context-analysis', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: text, matches: matches })
                });

                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                currentAnalysisData.contextAnalysis = data.context_analysis;
                displayContextAnalysisResults(data.context_analysis);
                return data;
                
            } catch (error) {
                displayMockContextAnalysis();
                return null;
            }
        }

        // ê°œì„  ì œì•ˆ
        async function runImprovementSuggestions(text, matches) {
            try {
                const response = await fetch('http://localhost:8006/api/premium/improvement-suggestions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: text, matches: matches })
                });

                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                currentAnalysisData.suggestions = data.suggestions;
                displayImprovementSuggestions(data.suggestions);
                return data;
                
            } catch (error) {
                displayMockImprovementSuggestions();
                return null;
            }
        }

        // ì‹¤ì œ ë°±ì—”ë“œ API í˜¸ì¶œ (êµ¬ ë²„ì „)
        async function checkBasicPlagiarism() {
            const text = document.getElementById('testText').value;
            const resultDiv = document.getElementById('apiResult');
            
            resultDiv.innerHTML = `
                <div class="panel">
                    <h2>ğŸ”¥ ì‹¤ì‹œê°„ API ê²°ê³¼</h2>
                    <div class="status checking">ğŸ“¡ ë°±ì—”ë“œì—ì„œ í‘œì ˆ ê²€ì‚¬ ì¤‘...</div>
                </div>
            `;

            try {
                const response = await fetch('http://localhost:8006/api/check/text', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        text: text,
                        check_web: true
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();
                displayApiResults(data, text);
                
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="panel">
                        <h2>ğŸ”¥ API ê²°ê³¼</h2>
                        <div class="status error">âŒ API ì—°ê²° ì‹¤íŒ¨: ${error.message}</div>
                        <p>ë°±ì—”ë“œ ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš” (http://localhost:8006)</p>
                    </div>
                `;
            }
        }

        // API ê²°ê³¼ í‘œì‹œ
        function displayApiResults(data, originalText) {
            const resultDiv = document.getElementById('apiResult');
            
            // í•˜ì´ë¼ì´íŠ¸ëœ í…ìŠ¤íŠ¸ ìƒì„±
            let highlightedText = originalText;
            if (data.matches && data.matches.length > 0) {
                // ë§¤ì¹˜ë¥¼ ì‹œì‘ ìœ„ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
                const sortedMatches = [...data.matches].sort((a, b) => a.start_index - b.start_index);
                
                // ë’¤ì—ì„œë¶€í„° í•˜ì´ë¼ì´íŠ¸ ì ìš© (ì¸ë±ìŠ¤ ë³´ì¡´)
                for (let i = sortedMatches.length - 1; i >= 0; i--) {
                    const match = sortedMatches[i];
                    const before = highlightedText.substring(0, match.start_index);
                    const highlighted = highlightedText.substring(match.start_index, match.end_index);
                    const after = highlightedText.substring(match.end_index);
                    
                    highlightedText = before + 
                        `<span class="highlight-new" title="í‘œì ˆ ì˜ì‹¬: ${match.similarity_score.toFixed(1)}% ìœ ì‚¬">${highlighted}</span>` + 
                        after;
                }
            }

            resultDiv.innerHTML = `
                <div class="panel">
                    <h2>ğŸ”¥ ì‹¤ì‹œê°„ API ê²°ê³¼</h2>
                    <div class="status success">âœ… ê²€ì‚¬ ì™„ë£Œ!</div>
                    
                    <div class="matches-info">
                        <strong>ğŸ“Š ê²€ì‚¬ ê²°ê³¼:</strong><br>
                        â€¢ ì „ì²´ ìœ ì‚¬ë„: ${data.similarity_score?.toFixed(1) || 0}%<br>
                        â€¢ ë°œê²¬ëœ ë§¤ì¹­: ${data.matches?.length || 0}ê°œ<br>
                        â€¢ ê²€ì‚¬ ID: ${data.id}<br>
                        â€¢ ìƒíƒœ: ${data.status}
                    </div>

                    <div class="result-text">
                        <strong>ğŸ¯ ê°œì„ ëœ í•˜ì´ë¼ì´íŠ¸ ê²°ê³¼:</strong><br><br>
                        ${highlightedText || originalText}
                    </div>

                    ${data.matches && data.matches.length > 0 ? `
                        <div class="matches-info">
                            <strong>ğŸ“ ë§¤ì¹­ ìƒì„¸ì •ë³´:</strong><br>
                            ${data.matches.map((match, i) => `
                                ${i + 1}. "${match.matched_text}" (${match.similarity_score.toFixed(1)}% ìœ ì‚¬)<br>
                                   ì¶œì²˜: ${match.source_title}<br>
                                   ìœ„ì¹˜: ${match.start_index}-${match.end_index}
                            `).join('<br>')}
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // ê¸°ë³¸ ê²°ê³¼ í‘œì‹œ
        function displayBasicResults(data, originalText) {
            let highlightedText = originalText;
            if (data.matches && data.matches.length > 0) {
                const sortedMatches = [...data.matches].sort((a, b) => a.start_index - b.start_index);
                
                for (let i = sortedMatches.length - 1; i >= 0; i--) {
                    const match = sortedMatches[i];
                    const before = highlightedText.substring(0, match.start_index);
                    const highlighted = highlightedText.substring(match.start_index, match.end_index);
                    const after = highlightedText.substring(match.end_index);
                    
                    highlightedText = before + 
                        `<span class="highlight-new" title="í‘œì ˆ ì˜ì‹¬: ${match.similarity_score?.toFixed(1) || 0}% ìœ ì‚¬">${highlighted}</span>` + 
                        after;
                }
            }

            document.getElementById('basic').innerHTML = `
                <div class="panel">
                    <h2>ğŸ” ê¸°ë³¸ í‘œì ˆ ê²€ì‚¬ ê²°ê³¼</h2>
                    <div class="status success">âœ… ê²€ì‚¬ ì™„ë£Œ!</div>
                    
                    <div class="matches-info">
                        <strong>ğŸ“Š ê²€ì‚¬ ê²°ê³¼:</strong><br>
                        â€¢ ì „ì²´ ìœ ì‚¬ë„: ${data.similarity_score?.toFixed(1) || 0}%<br>
                        â€¢ ë°œê²¬ëœ ë§¤ì¹­: ${data.matches?.length || 0}ê°œ<br>
                        â€¢ ê²€ì‚¬ ID: ${data.id}<br>
                        â€¢ ìƒíƒœ: ${data.status}
                    </div>

                    <div class="result-text">
                        <strong>ğŸ¯ ì •í™•í•œ í•˜ì´ë¼ì´íŠ¸ ê²°ê³¼:</strong><br><br>
                        ${highlightedText}
                    </div>

                    ${data.matches && data.matches.length > 0 ? `
                        <div class="matches-info">
                            <strong>ğŸ“ ë§¤ì¹­ ìƒì„¸ì •ë³´:</strong><br>
                            ${data.matches.map((match, i) => `
                                ${i + 1}. "${match.matched_text}" (${match.similarity_score?.toFixed(1) || 0}% ìœ ì‚¬)<br>
                                   ì¶œì²˜: ${match.source_title}<br>
                                   ìœ„ì¹˜: ${match.start_index}-${match.end_index}
                            `).join('<br>')}
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // AI ë¶„ì„ ê²°ê³¼ í‘œì‹œ
        function displayAIAnalysisResults(analysis) {
            document.getElementById('ai-analysis').innerHTML = `
                <div class="panel">
                    <h2>ğŸ¤– AI ê¸€ì“°ê¸° ë¶„ì„</h2>
                    
                    <div class="feature-grid" style="grid-template-columns: 1fr 1fr;">
                        <div class="feature-card">
                            <h3>ğŸ“Š ê¸€ì“°ê¸° í†µê³„</h3>
                            <p><strong>ë¬¸ì¥ ìˆ˜:</strong> ${analysis.sentence_count || 'N/A'}</p>
                            <p><strong>ë‹¨ì–´ ìˆ˜:</strong> ${analysis.word_count || 'N/A'}</p>
                            <p><strong>í‰ê·  ë¬¸ì¥ ê¸¸ì´:</strong> ${analysis.avg_sentence_length || 'N/A'}</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3>ğŸ¯ ë¬¸ì²´ ë¶„ì„</h3>
                            <p><strong>ê°ì§€ëœ ìŠ¤íƒ€ì¼:</strong> 
                                <span class="badge badge-info">${analysis.detected_style || 'ë¶„ì„ì¤‘'}</span>
                            </p>
                            <p><strong>ì–´ì¡°:</strong> 
                                <span class="badge badge-success">${analysis.tone || 'ì¤‘ì„±ì '}</span>
                            </p>
                        </div>
                    </div>

                    <div class="feature-card">
                        <h3>ğŸ“š ì ìˆ˜ ë¶„ì„</h3>
                        <div style="margin: 10px 0;">
                            <p><strong>í•™ìˆ ì„± ì ìˆ˜:</strong> ${analysis.academic_score || 5}/10</p>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${(analysis.academic_score || 5) * 10}%; background: #2196f3;"></div>
                            </div>
                        </div>
                        <div style="margin: 10px 0;">
                            <p><strong>ë³µì¡ë„ ì ìˆ˜:</strong> ${analysis.complexity_score || 6}/10</p>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${(analysis.complexity_score || 6) * 10}%; background: #ff9800;"></div>
                            </div>
                        </div>
                    </div>

                    ${analysis.improvement_areas ? `
                        <div class="improvement-section">
                            <h3>ğŸ¯ ê°œì„  ê°€ëŠ¥ ì˜ì—­</h3>
                            <p>${analysis.improvement_areas.join(', ')}</p>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // ë§¥ë½ ë¶„ì„ ê²°ê³¼ í‘œì‹œ
        function displayContextAnalysisResults(context) {
            const getRiskColor = (risk) => {
                if (risk.includes('ë†’ìŒ')) return 'danger';
                if (risk.includes('ë³´í†µ')) return 'warning';
                return 'success';
            };

            document.getElementById('context').innerHTML = `
                <div class="panel">
                    <h2>ğŸ¯ í‘œì ˆ ë§¥ë½ ë¶„ì„</h2>
                    
                    <div class="feature-grid" style="grid-template-columns: 1fr 1fr;">
                        <div class="feature-card">
                            <h3>âš ï¸ ìœ„í—˜ë„ í‰ê°€</h3>
                            <span class="badge badge-${getRiskColor(context.ìœ„í—˜ë„ || 'ë‚®ìŒ')}">${context.ìœ„í—˜ë„ || 'ë‚®ìŒ'}</span>
                            
                            <h3 style="margin-top: 15px;">ğŸ” í‘œì ˆ ìœ í˜•</h3>
                            <p>${context.í‘œì ˆ_ìœ í˜• || 'ë¶€ë¶„ì  ìœ ì‚¬ì„±'}</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3>ğŸ“Š ì‹¬ê°ë„</h3>
                            <span class="badge badge-${getRiskColor(context.ì‹¬ê°ë„ || 'ë‚®ìŒ')}">${context.ì‹¬ê°ë„ || 'ë‚®ìŒ'}</span>
                            
                            <h3 style="margin-top: 15px;">âš–ï¸ ë²•ì  ìœ„í—˜ë„</h3>
                            <span class="badge badge-${getRiskColor(context.ë²•ì _ìœ„í—˜ë„ || 'ë‚®ìŒ')}">${context.ë²•ì _ìœ„í—˜ë„ || 'ë‚®ìŒ'}</span>
                        </div>
                    </div>

                    <div class="improvement-section">
                        <h3>ğŸ’¡ ë§¥ë½ ê¸°ë°˜ ê°œì„  ì œì•ˆ</h3>
                        <ul>
                            ${(context.ê°œì„ _ì œì•ˆ || ['ë…ì°½ì ì¸ ë‚´ìš©ì…ë‹ˆë‹¤.']).map(suggestion => 
                                `<li>${suggestion}</li>`
                            ).join('')}
                        </ul>
                    </div>
                </div>
            `;
        }

        // ê°œì„  ì œì•ˆ ê²°ê³¼ í‘œì‹œ
        function displayImprovementSuggestions(suggestions) {
            document.getElementById('suggestions').innerHTML = `
                <div class="panel">
                    <h2>ğŸ’¡ AI ê¸°ë°˜ ê°œì„  ì œì•ˆ</h2>
                    
                    ${suggestions.synonym_suggestions ? `
                        <div class="ai-suggestion">
                            <h3>ğŸ”„ ë™ì˜ì–´ ì œì•ˆ</h3>
                            ${suggestions.synonym_suggestions.map(suggestion => `
                                <div style="margin: 10px 0; padding: 10px; background: white; border-radius: 5px;">
                                    <strong>"${suggestion.original}"</strong> â†’ 
                                    <em>"${suggestion.alternatives.join(', ')}"</em>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}

                    ${suggestions.restructuring_suggestions ? `
                        <div class="ai-suggestion">
                            <h3>ğŸ“ ë¬¸ì¥ ì¬êµ¬ì„± ì œì•ˆ</h3>
                            ${suggestions.restructuring_suggestions.map(suggestion => `
                                <div style="margin: 10px 0; padding: 15px; background: white; border-radius: 5px;">
                                    <div><strong>ì›ë¬¸:</strong> ${suggestion.original}</div>
                                    <div style="margin-top: 8px;"><strong>ê°œì„ ì•ˆ:</strong> ${suggestion.improved}</div>
                                    <div style="margin-top: 8px; color: #666;"><strong>ì´ìœ :</strong> ${suggestion.reason}</div>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}

                    ${suggestions.citation_guide ? `
                        <div class="improvement-section">
                            <h3>ğŸ“š ì¸ìš© ê°€ì´ë“œ</h3>
                            <ul>
                                ${suggestions.citation_guide.map(guide => `<li>${guide}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // í”„ë¦¬ë¯¸ì—„ ìš”ì•½ í‘œì‹œ
        function displayPremiumSummary() {
            document.getElementById('premium').innerHTML = `
                <div class="premium-card">
                    <h2>âœ¨ AI ê¸°ë°˜ í”„ë¦¬ë¯¸ì—„ ë¶„ì„ ì™„ë£Œ!</h2>
                    <p>ëª¨ë“  ê³ ê¸‰ ê¸°ëŠ¥ì´ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                </div>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <h3>ğŸ¯ í•µì‹¬ íŠ¹ì§•</h3>
                        <ul>
                            <li>âœ… ì •í™•í•œ í•˜ì´ë¼ì´íŠ¸ (ë‹¨ì–´/êµ¬ë¬¸ ë‹¨ìœ„)</li>
                            <li>ğŸ¤– AI ê¸°ë°˜ ê¸€ì“°ê¸° ìŠ¤íƒ€ì¼ ë¶„ì„</li>
                            <li>ğŸ” ë§¥ë½ì  í‘œì ˆ ìœ„í—˜ë„ í‰ê°€</li>
                            <li>ğŸ’¡ ì‹¤ì‹œê°„ ê°œì„  ì œì•ˆ</li>
                        </ul>
                    </div>
                    
                    <div class="feature-card">
                        <h3>ğŸš€ ì°¨ë³„í™” í¬ì¸íŠ¸</h3>
                        <ul>
                            <li>ğŸ¯ ê¸°ì¡´: ì „ì²´ ë¬¸ì¥ â†’ ìš°ë¦¬: ì •í™•í•œ êµ¬ê°„</li>
                            <li>ğŸ“Š ë‹¨ìˆœ ìœ ì‚¬ë„ â†’ ë§¥ë½ ê¸°ë°˜ ë¶„ì„</li>
                            <li>âŒ ì‚¬í›„ ê²€ì‚¬ â†’ âœ… ì‹¤ì‹œê°„ ë„ì›€</li>
                            <li>ğŸ¤– AIê°€ ì§ì ‘ ê°œì„ ì•ˆ ì œì‹œ</li>
                        </ul>
                    </div>
                    
                    <div class="feature-card">
                        <h3>ğŸ“ˆ ê¸°ìˆ  ìŠ¤íƒ</h3>
                        <ul>
                            <li>ğŸ FastAPI + SQLite (ë°±ì—”ë“œ)</li>
                            <li>âš›ï¸ React + TypeScript (í”„ë¡ íŠ¸ì—”ë“œ)</li>
                            <li>ğŸ¤– ìì²´ ê°œë°œ AI ë¶„ì„ ì—”ì§„</li>
                            <li>ğŸŒ ì‹¤ì‹œê°„ ì›¹ í¬ë¡¤ë§</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        // ëª¨ë“  ê¸°ëŠ¥ ë¯¸ë¦¬ë³´ê¸°
        function showAllFeatures() {
            const text = document.getElementById('testText').value;
            
            displayMockBasicResults(text);
            displayMockAIAnalysis(text);
            displayMockContextAnalysis();
            displayMockImprovementSuggestions();
            displayPremiumSummary();
        }

        // ëª¨ì˜ ê²°ê³¼ë“¤
        function displayMockBasicResults(text) {
            const mockData = {
                id: "demo-" + Date.now(),
                status: "completed", 
                similarity_score: 42.8,
                matches: [
                    {
                        matched_text: "í˜„ëŒ€ ê¸°ìˆ  ë°œì „",
                        source_title: "ì¸ê³µì§€ëŠ¥ - ìœ„í‚¤ë°±ê³¼",
                        similarity_score: 89.2,
                        start_index: text.indexOf("í˜„ëŒ€ ê¸°ìˆ  ë°œì „"),
                        end_index: text.indexOf("í˜„ëŒ€ ê¸°ìˆ  ë°œì „") + "í˜„ëŒ€ ê¸°ìˆ  ë°œì „".length
                    },
                    {
                        matched_text: "ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹",
                        source_title: "ì¸ê³µì§€ëŠ¥ - ë‚˜ë¬´ìœ„í‚¤",
                        similarity_score: 94.5,
                        start_index: text.indexOf("ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹"),
                        end_index: text.indexOf("ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹") + "ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹".length
                    },
                    {
                        matched_text: "ìì—°ì–´ ì²˜ë¦¬",
                        source_title: "AI ê¸°ìˆ  ë¸”ë¡œê·¸",
                        similarity_score: 76.3,
                        start_index: text.indexOf("ìì—°ì–´ ì²˜ë¦¬"),
                        end_index: text.indexOf("ìì—°ì–´ ì²˜ë¦¬") + "ìì—°ì–´ ì²˜ë¦¬".length
                    }
                ]
            };
            displayBasicResults(mockData, text);
        }

        function displayMockAIAnalysis(text) {
            const mockAnalysis = {
                sentence_count: 4,
                word_count: 65,
                avg_sentence_length: 16.3,
                detected_style: "í•™ìˆ ì /ê¸°ìˆ ì ",
                tone: "ì¤‘ë¦½ì -ì „ë¬¸ì ", 
                academic_score: 8,
                complexity_score: 7,
                improvement_areas: ["ë¬¸ì¥ ë‹¤ì–‘ì„±", "êµ¬ì²´ì  ì‚¬ë¡€ ì¶”ê°€"]
            };
            displayAIAnalysisResults(mockAnalysis);
        }

        function displayMockContextAnalysis() {
            const mockContext = {
                ìœ„í—˜ë„: "ë³´í†µ (ì£¼ì˜ í•„ìš”)",
                í‘œì ˆ_ìœ í˜•: "ë¶€ë¶„ì  ê°œë… ì°¨ìš©",
                ì‹¬ê°ë„: "ì¤‘ê°„ (ì¼ë¶€ ìˆ˜ì • ê¶Œì¥)",
                ë²•ì _ìœ„í—˜ë„: "ë‚®ìŒ (í•™ìˆ  ì¸ìš© ë²”ìœ„)",
                ê°œì„ _ì œì•ˆ: [
                    "ğŸŸ¡ ì¼ë¶€ êµ¬ê°„ì—ì„œ ìœ ì‚¬ì„±ì´ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤",
                    "ğŸ’¡ í•µì‹¬ ê°œë…ì€ ìœ ì§€í•˜ë˜ í‘œí˜„ì„ ë‹¤ì–‘í™”í•˜ì„¸ìš”",
                    "ğŸ“š ì¶œì²˜ë¥¼ ëª…í™•íˆ í•˜ì—¬ ì¸ìš©ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤",
                    "âœï¸ ë™ì˜ì–´ë‚˜ ìœ ì˜ì–´ë¥¼ í™œìš©í•´ ë¬¸ì¥ì„ ì¬êµ¬ì„±í•´ë³´ì„¸ìš”"
                ]
            };
            displayContextAnalysisResults(mockContext);
        }

        function displayMockImprovementSuggestions() {
            const mockSuggestions = {
                synonym_suggestions: [
                    {
                        original: "í˜„ëŒ€ ê¸°ìˆ  ë°œì „",
                        alternatives: ["ìµœì‹  ê¸°ìˆ  ì§„ë³´", "ì²¨ë‹¨ ê¸°ìˆ  í˜ì‹ ", "ì‹ ê¸°ìˆ  ë°œë‹¬"]
                    },
                    {
                        original: "ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹", 
                        alternatives: ["ê¸°ê³„í•™ìŠµê³¼ ì‹¬ì¸µí•™ìŠµ", "MLê³¼ DL", "ì¸ê³µì§€ëŠ¥ í•™ìŠµ ê¸°ë²•"]
                    }
                ],
                restructuring_suggestions: [
                    {
                        original: "ì¸ê³µì§€ëŠ¥ì€ í˜„ëŒ€ ê¸°ìˆ  ë°œì „ì˜ í•µì‹¬ ìš”ì†Œì…ë‹ˆë‹¤.",
                        improved: "AI ê¸°ìˆ ì€ ì˜¤ëŠ˜ë‚  í˜ì‹ ì˜ ì¤‘ì‹¬ì¶• ì—­í• ì„ ë‹´ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
                        reason: "ë” êµ¬ì²´ì ì´ê³  ë…ì°½ì ì¸ í‘œí˜„ìœ¼ë¡œ ê°œì„ "
                    },
                    {
                        original: "ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹ì„ í†µí•´ ì»´í“¨í„°ê°€ í•™ìŠµí•˜ê³  íŒë‹¨í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.",
                        improved: "ê¸°ê³„í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì˜ ë°œì „ìœ¼ë¡œ ì»´í“¨í„° ì‹œìŠ¤í…œì´ ììœ¨ì  ì˜ì‚¬ê²°ì • ëŠ¥ë ¥ì„ ê°–ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.",
                        reason: "ê¸°ìˆ ì  ì •í™•ì„±ì„ ë†’ì´ê³  í‘œí˜„ì„ ì„¸ë ¨ë˜ê²Œ ê°œì„ "
                    }
                ],
                citation_guide: [
                    "ğŸ“š ì¸ìš©ì´ í•„ìš”í•œ êµ¬ê°„ì—ëŠ” ì ì ˆí•œ ì¶œì²˜ í‘œê¸°ë¥¼ ì¶”ê°€í•˜ì„¸ìš”",
                    "ğŸ’¡ í†µê³„ë‚˜ ì—°êµ¬ ê²°ê³¼ëŠ” ë°˜ë“œì‹œ ì›ë³¸ ì¶œì²˜ë¥¼ ëª…ì‹œí•˜ì„¸ìš”",
                    "âœ… ê°œì¸ì  ì˜ê²¬ê³¼ ì¸ìš© ë‚´ìš©ì„ ëª…í™•íˆ êµ¬ë¶„í•˜ì„¸ìš”"
                ]
            };
            displayImprovementSuggestions(mockSuggestions);
        }

        function displayError(message) {
            document.getElementById('apiResult').innerHTML = `
                <div class="panel">
                    <div class="status error">âŒ ${message}</div>
                </div>
            `;
        }

        // ëª¨ì˜ ê²°ê³¼ í‘œì‹œ (êµ¬ë²„ì „ í˜¸í™˜)
        function showMockResults() {
            const text = document.getElementById('testText').value;
            const mockData = {
                id: "mock-test-" + Date.now(),
                status: "completed",
                similarity_score: 45.2,
                matches: [
                    {
                        matched_text: "í˜„ëŒ€ ê¸°ìˆ  ë°œì „",
                        source_title: "ì¸ê³µì§€ëŠ¥ - ìœ„í‚¤ë°±ê³¼",
                        similarity_score: 87.5,
                        start_index: text.indexOf("í˜„ëŒ€ ê¸°ìˆ  ë°œì „"),
                        end_index: text.indexOf("í˜„ëŒ€ ê¸°ìˆ  ë°œì „") + "í˜„ëŒ€ ê¸°ìˆ  ë°œì „".length
                    },
                    {
                        matched_text: "ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹",
                        source_title: "ì¸ê³µì§€ëŠ¥ - ë‚˜ë¬´ìœ„í‚¤", 
                        similarity_score: 92.3,
                        start_index: text.indexOf("ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹"),
                        end_index: text.indexOf("ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹") + "ë¨¸ì‹ ëŸ¬ë‹ê³¼ ë”¥ëŸ¬ë‹".length
                    }
                ]
            };
            
            displayApiResults(mockData, text);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = function() {
            checkBackendStatus();
            showAllFeatures(); // ëª¨ë“  ê¸°ëŠ¥ ë¯¸ë¦¬ë³´ê¸°
        };
    </script>
</body>
</html>